# Plataforma de Reciclaje MVC

Una aplicaci√≥n web completa desarrollada con arquitectura MVC para la gesti√≥n y seguimiento de actividades de reciclaje. Permite a los usuarios reportar sus actividades de reciclaje, visualizar estad√≠sticas y realizar un seguimiento de su impacto ambiental.

## üåü Caracter√≠sticas

- **Arquitectura MVC**: Separaci√≥n clara de responsabilidades
- **Sistema de Autenticaci√≥n**: Registro, login y recuperaci√≥n de contrase√±a
- **Gesti√≥n de Reportes**: CRUD completo para reportes de reciclaje
- **Dashboard Interactivo**: Estad√≠sticas personalizadas y generales
- **An√°lisis de Datos**: Gr√°ficos y visualizaciones avanzadas
- **Sistema de Puntos**: Gamificaci√≥n para motivar el reciclaje
- **Responsive Design**: Compatible con dispositivos m√≥viles
- **API REST**: Endpoints para integraci√≥n externa
- **Seguridad**: Protecci√≥n CSRF, validaci√≥n de datos, sanitizaci√≥n

## üõ†Ô∏è Tecnolog√≠as Utilizadas

- **Backend**: PHP 7.4+
- **Base de Datos**: MySQL 8.0+
- **Frontend**: HTML5, CSS3, JavaScript ES6+
- **Frameworks CSS**: Bootstrap 5
- **Gr√°ficos**: Chart.js
- **Iconos**: Font Awesome
- **Arquitectura**: MVC (Model-View-Controller)

## üìã Requisitos del Sistema

- PHP 7.4 o superior
- MySQL 8.0 o superior
- Servidor web (Apache/Nginx)
- Extensiones PHP requeridas:
  - PDO
  - MySQL
  - mbstring
  - fileinfo
  - GD (opcional, para manipulaci√≥n de im√°genes)

## üöÄ Instalaci√≥n

### 1. Clonar el repositorio

```bash
git clone <URL_DEL_REPOSITORIO>
cd reciclaje_platform_mvc_working
```

### 2. Configurar el entorno

1. Copiar el archivo de configuraci√≥n:
```bash
cp .env.example .env
```

2. Editar `.env` con tus configuraciones:
```env
# Configuraci√≥n de Base de Datos
DB_HOST=localhost
DB_PORT=3306
DB_NAME=reciclaje_db
DB_USER=tu_usuario
DB_PASSWORD=tu_contrase√±a

# Configuraci√≥n de la Aplicaci√≥n
APP_NAME="Plataforma de Reciclaje"
APP_ENV=production
APP_DEBUG=false
APP_URL=http://tu-dominio.com

# Configuraci√≥n de Seguridad
APP_KEY=tu_clave_secreta_aqui_cambiar_en_produccion
SALT=tu_salt_personalizado
```

### 3. Configurar la base de datos

1. Crear la base de datos:
```sql
CREATE DATABASE reciclaje_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

2. Importar el esquema:
```bash
mysql -u tu_usuario -p reciclaje_db < database_schema.sql
```

### 4. Configurar permisos

```bash
# Permisos para directorios de escritura
chmod 755 storage/logs/
chmod 755 public/uploads/

# Asegurar que el servidor web puede escribir
chown -R www-data:www-data storage/
chown -R www-data:www-data public/uploads/
```

### 5. Configurar servidor web

#### Apache (.htaccess)
```apache
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [QSA,L]
```

#### Nginx
```nginx
location / {
    try_files $uri $uri/ /index.php?$query_string;
}

location ~ \.php$ {
    fastcgi_pass unix:/var/run/php/php7.4-fpm.sock;
    fastcgi_index index.php;
    fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
    include fastcgi_params;
}
```

## üîß Configuraci√≥n

### Variables de Entorno

| Variable | Descripci√≥n | Valor por defecto |
|----------|-------------|-------------------|
| `DB_HOST` | Host de la base de datos | localhost |
| `DB_PORT` | Puerto de la base de datos | 3306 |
| `DB_NAME` | Nombre de la base de datos | reciclaje_db |
| `DB_USER` | Usuario de la base de datos | root |
| `DB_PASSWORD` | Contrase√±a de la base de datos | (vac√≠o) |
| `APP_NAME` | Nombre de la aplicaci√≥n | Plataforma de Reciclaje |
| `APP_ENV` | Entorno de la aplicaci√≥n | production |
| `APP_DEBUG` | Modo debug | false |
| `APP_URL` | URL base de la aplicaci√≥n | http://localhost |
| `APP_KEY` | Clave de encriptaci√≥n | (generar una segura) |
| `SALT` | Salt para contrase√±as | (generar uno seguro) |

### Configuraci√≥n de Uploads

- Tama√±o m√°ximo: 5MB (configurable en `config/app.php`)
- Tipos permitidos: jpg, jpeg, png, gif, pdf
- Directorio: `public/uploads/`

## üìñ Uso

### Acceso Inicial

1. Visita tu dominio en el navegador
2. Crea una cuenta o usa las credenciales de demo:
   - Email: `demo@ejemplo.com`
   - Contrase√±a: `demo123`

### Funcionalidades Principales

#### üìä Dashboard
- Estad√≠sticas personales de reciclaje
- Gr√°ficos interactivos
- Ranking de usuarios
- Impacto ambiental calculado

#### üìù Gesti√≥n de Reportes
- Crear nuevos reportes de reciclaje
- Editar reportes existentes
- Subir fotos de evidencia
- Filtrar y buscar reportes

#### üìà Estad√≠sticas
- An√°lisis detallado de datos
- Comparativas por per√≠odos
- Proyecciones de tendencias
- Exportaci√≥n de datos (CSV/JSON)

#### üë§ Perfil de Usuario
- Actualizar informaci√≥n personal
- Cambiar contrase√±a
- Ver historial de actividad

## üîå API

### Endpoints Disponibles

#### Autenticaci√≥n
```
POST /api/login          - Iniciar sesi√≥n
POST /api/register       - Registrar usuario
POST /api/logout         - Cerrar sesi√≥n
GET  /api/check-auth     - Verificar autenticaci√≥n
```

#### Reportes
```
GET    /api/reportes           - Listar reportes
POST   /api/reportes           - Crear reporte
GET    /api/reportes/{id}      - Obtener reporte
PUT    /api/reportes/{id}      - Actualizar reporte
DELETE /api/reportes/{id}      - Eliminar reporte
```

#### Estad√≠sticas
```
GET /api/estadisticas/datos    - Datos generales
GET /api/estadisticas/graficos - Datos para gr√°ficos
```

### Ejemplo de Uso

```javascript
// Crear un nuevo reporte
fetch('/api/reportes', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'X-Requested-With': 'XMLHttpRequest'
    },
    body: JSON.stringify({
        tipo_material: 'plastico',
        cantidad: 2.5,
        ubicacion: 'Centro de la Ciudad',
        descripcion: 'Botellas de agua'
    })
})
.then(response => response.json())
.then(data => console.log(data));
```

## üèóÔ∏è Arquitectura

### Estructura de Directorios

```
reciclaje_platform_mvc_working/
‚îú‚îÄ‚îÄ app/                          # C√≥digo de la aplicaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ Core/                     # N√∫cleo del framework
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.php              # Clase principal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Controller.php       # Controlador base
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Database.php         # Manejo de BD
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Model.php            # Modelo base
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Router.php           # Enrutamiento
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ View.php             # Sistema de vistas
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/             # Controladores
‚îÇ   ‚îú‚îÄ‚îÄ Models/                  # Modelos
‚îÇ   ‚îî‚îÄ‚îÄ Views/                   # Vistas
‚îú‚îÄ‚îÄ config/                      # Configuraci√≥n
‚îú‚îÄ‚îÄ public/                      # Archivos p√∫blicos
‚îÇ   ‚îú‚îÄ‚îÄ assets/                  # CSS, JS, im√°genes
‚îÇ   ‚îî‚îÄ‚îÄ uploads/                 # Archivos subidos
‚îú‚îÄ‚îÄ storage/                     # Almacenamiento
‚îÇ   ‚îî‚îÄ‚îÄ logs/                    # Logs del sistema
‚îú‚îÄ‚îÄ .env                         # Variables de entorno
‚îú‚îÄ‚îÄ .env.example                 # Ejemplo de configuraci√≥n
‚îú‚îÄ‚îÄ database_schema.sql          # Esquema de BD
‚îî‚îÄ‚îÄ index.php                    # Punto de entrada
```

### Patr√≥n MVC

#### Modelos (Models)
- `User.php`: Gesti√≥n de usuarios
- `Report.php`: Gesti√≥n de reportes
- `Stats.php`: Estad√≠sticas y an√°lisis

#### Vistas (Views)
- `layouts/main.php`: Layout principal
- `home/`: P√°ginas p√∫blicas
- `auth/`: Autenticaci√≥n
- `dashboard/`: Panel de usuario
- `reports/`: Gesti√≥n de reportes

#### Controladores (Controllers)
- `HomeController.php`: P√°gina principal
- `AuthController.php`: Autenticaci√≥n
- `DashboardController.php`: Panel de usuario
- `ReportController.php`: Gesti√≥n de reportes
- `StatsController.php`: Estad√≠sticas

## üîí Seguridad

### Medidas Implementadas

1. **Protecci√≥n CSRF**: Tokens en formularios
2. **Validaci√≥n de Datos**: Sanitizaci√≥n de entradas
3. **Prepared Statements**: Prevenci√≥n de SQL injection
4. **Hash de Contrase√±as**: bcrypt con salt personalizado
5. **Validaci√≥n de Archivos**: Tipos y tama√±os permitidos
6. **Escape de Salida**: Prevenci√≥n de XSS

### Configuraci√≥n de Seguridad

```php
// Ejemplo de configuraci√≥n en config/app.php
'security' => [
    'password_min_length' => 6,
    'session_regenerate' => true,
    'csrf_protection' => true,
],
```

## üß™ Testing

### Testing Manual

1. Registro de usuario
2. Login/logout
3. Creaci√≥n de reportes
4. Edici√≥n de reportes
5. Visualizaci√≥n de estad√≠sticas
6. Upload de archivos

### Casos de Prueba

- ‚úÖ Validaci√≥n de formularios
- ‚úÖ Manejo de errores de BD
- ‚úÖ Protecci√≥n CSRF
- ‚úÖ Sanitizaci√≥n de datos
- ‚úÖ Responsive design

## üìä Base de Datos

### Tablas Principales

#### usuarios
- Informaci√≥n de usuarios registrados
- Autenticaci√≥n y perfiles

#### reportes
- Reportes de actividades de reciclaje
- Relaci√≥n con usuarios

#### password_resets
- Tokens para recuperaci√≥n de contrase√±a

#### configuracion
- Configuraci√≥n del sistema

### Vistas y Funciones

- `vista_estadisticas_generales`: Estad√≠sticas r√°pidas
- `vista_ranking_usuarios`: Ranking de usuarios
- `calcular_co2_evitado()`: C√°lculo de impacto ambiental

## üîÑ Mantenimiento

### Logs

Los logs se almacenan en `storage/logs/`:
- `app.log`: Log general de la aplicaci√≥n
- `database.log`: Log de base de datos
- `contact.log`: Mensajes de contacto

### Limpieza de Datos

Ejecutar peri√≥dicamente:
```sql
CALL limpiar_datos_antiguos();
```

### Backup

Recomendado hacer backup diario:
```bash
mysqldump -u usuario -p reciclaje_db > backup_$(date +%Y%m%d).sql
```

## üö® Soluci√≥n de Problemas

### Errores Comunes

#### Error de conexi√≥n a BD
1. Verificar credenciales en `.env`
2. Comprobar que el servicio MySQL est√© activo
3. Verificar permisos del usuario de BD

#### Errores de permisos
```bash
# Corregir permisos
chmod 755 storage/logs/
chmod 755 public/uploads/
chown -R www-data:www-data storage/
```

#### Error 404 en rutas
1. Verificar configuraci√≥n de servidor web
2. Comprobar archivo `.htaccess` (Apache)
3. Verificar configuraci√≥n Nginx

### Debug

Para activar el modo debug:
```env
APP_DEBUG=true
```

## ü§ù Contribuci√≥n

### Pautas de Desarrollo

1. Seguir PSR-4 para autoloading
2. Documentar c√≥digo con PHPDoc
3. Usar nombres descriptivos
4. Validar todas las entradas
5. Manejar errores apropiadamente

### Estructura de Commits

```
tipo(scope): descripci√≥n

feat(auth): agregar recuperaci√≥n de contrase√±a
fix(reports): corregir validaci√≥n de fechas
docs(readme): actualizar instrucciones de instalaci√≥n
```

## üìù Changelog

### v1.0.0 (2025-01-07)
- ‚ú® Implementaci√≥n inicial del sistema MVC
- üîê Sistema de autenticaci√≥n completo
- üìä Dashboard con estad√≠sticas
- üìù Gesti√≥n de reportes CRUD
- üìà Sistema de an√°lisis y gr√°ficos
- üé® Dise√±o responsive con Bootstrap 5
- üîå API REST funcional
- üõ°Ô∏è Medidas de seguridad implementadas

## üìÑ Licencia

Este proyecto est√° licenciado bajo la Licencia MIT. Ver el archivo `LICENSE` para m√°s detalles.

## üë• Autores

- **Desarrollador Principal**: [Tu Nombre]
- **Contribuidores**: Ver `CONTRIBUTORS.md`

## üìû Soporte

Para soporte t√©cnico:
- üìß Email: soporte@plataforma-reciclaje.com
- üìã Issues: [GitHub Issues]
- üìñ Wiki: [Documentaci√≥n Wiki]

## üôè Agradecimientos

- Bootstrap por el framework CSS
- Chart.js por las visualizaciones
- Font Awesome por los iconos
- Comunidad PHP por las mejores pr√°cticas

---

**¬°Gracias por usar la Plataforma de Reciclaje MVC! Juntos construimos un futuro m√°s sostenible. üå±**
